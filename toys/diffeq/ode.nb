(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     30277,        684]
NotebookOptionsPosition[     29850,        666]
NotebookOutlinePosition[     30210,        682]
CellTagsIndexPosition[     30167,        679]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", " ", "=", " ", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
   RowBox[{"xmax", "/", "nmax"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theTitle", " ", "=", " ", 
   RowBox[{"StringForm", "[", 
    RowBox[{"\"\<\[CapitalDelta]x = ``\>\"", ",", " ", 
     RowBox[{"\[CapitalDelta]x", "//", "N"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theX", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"n", " ", "\[CapitalDelta]x"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theExactSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y0", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", " ", "n"}], " ", "\[CapitalDelta]x"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theNumericalSoln", " ", "=", "  ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y0", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", " ", "\[CapitalDelta]x"}], ")"}], "^", "n"}]}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theImplicitSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y0", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", " ", "\[CapitalDelta]x"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "n"}], ")"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "theExactSoln", ",", " ", "theNumericalSoln", ",", " ", 
     "theImplicitSoln"}], "}"}], ",", " ", 
   RowBox[{"DataRange", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "xmax"}], "}"}]}], ",", " ", 
   RowBox[{"PlotLegend", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Exact\>\"", ",", " ", "\"\<Numerical\>\"", ",", " ", 
      "\"\<Implicit\>\""}], "}"}]}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", " ", "theTitle"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6054638793268948`*^9, 3.605464073742174*^9}, {
   3.605464109315296*^9, 3.605464240641686*^9}, {3.605464289278036*^9, 
   3.605464290261372*^9}, {3.6054643415442333`*^9, 3.6054643577988253`*^9}, {
   3.605464470898169*^9, 3.605464564278079*^9}, {3.605464661157659*^9, 
   3.6054647283349867`*^9}, {3.6054651368865*^9, 3.6054651406886787`*^9}, {
   3.605465179180091*^9, 3.60546520711954*^9}, {3.605465264919607*^9, 
   3.605465320638517*^9}, {3.605465463811634*^9, 3.605465467964028*^9}, {
   3.60546558852789*^9, 3.605465603147156*^9}, {3.605466642416573*^9, 
   3.605466642513679*^9}, 3.605466697643506*^9, {3.6054667304262667`*^9, 
   3.605466731010158*^9}, 3.6054667807687473`*^9, {3.605466857895268*^9, 
   3.605466857999436*^9}, {3.605466889617135*^9, 3.605466890241385*^9}, {
   3.6054670225478163`*^9, 3.605467137113796*^9}, {3.605467249693227*^9, 
   3.6054672774234457`*^9}}],

Cell[BoxData[{
 RowBox[{"n1max", "=", "40"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]x1", " ", "=", " ", 
  RowBox[{
   RowBox[{"xmax", "/", "n1max"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]x2", " ", "=", " ", 
  RowBox[{
   RowBox[{"4", " ", "\[Delta]x1"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2max", "=", 
   RowBox[{"n1max", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theExactSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", " ", "\[Delta]x1"}], ",", 
       RowBox[{"y0", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", " ", "n"}], " ", "\[Delta]x1"}], "]"}]}]}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "n1max"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theNumericalSoln", " ", "=", "  ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", " ", "\[Delta]x1"}], ",", " ", 
       RowBox[{"y0", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", " ", "\[Delta]x1"}], ")"}], "^", "n"}]}]}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "n1max"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theImplicitSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", " ", "\[Delta]x2"}], ",", 
       RowBox[{"y0", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", " ", "\[Delta]x2"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"-", "n"}], ")"}]}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "n2max"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "theExactSoln", ",", " ", "theNumericalSoln", ",", " ", 
     "theImplicitSoln"}], "}"}], ",", " ", 
   RowBox[{"PlotLegend", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Exact\>\"", ",", " ", "\"\<Numerical\>\"", ",", " ", 
      "\"\<Implicit\>\""}], "}"}]}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.605465790690913*^9, 3.6054659977873287`*^9}, {
   3.6054660336460543`*^9, 3.605466156313572*^9}, {3.6054661992539253`*^9, 
   3.605466199343474*^9}, {3.60546626523359*^9, 3.605466270437065*^9}, 
   3.6054663577390747`*^9, {3.605466405019492*^9, 3.605466415375917*^9}, {
   3.605466498955806*^9, 3.605466505990117*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"init", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reg", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "\[Delta]t"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]t"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"impl", " ", "=", " ", 
  RowBox[{"Inverse", "[", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"-", "\[Delta]t"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Delta]t", ",", " ", "1"}], "}"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implV", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"\[Delta]t", "^", "2"}]}], ",", " ", "\[Delta]t"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]t"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implX", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "\[Delta]t"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]t"}], ",", " ", 
       RowBox[{"1", "-", 
        RowBox[{"\[Delta]t", "^", "2"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"implVX", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"implV", ".", "implX"}], "  ", "/.", " ", 
    RowBox[{"\[Delta]t", "\[Rule]", 
     RowBox[{"\[Delta]t", "/", "2"}]}]}], "//", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{"implXV", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"implX", ".", "implV"}], " ", "/.", " ", 
    RowBox[{"\[Delta]t", "\[Rule]", 
     RowBox[{"\[Delta]t", "/", "2"}]}]}], "//", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcL", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reg", ",", " ", "\"\<Fwd Euler\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"impl", ",", " ", "\"\<Euler Implicit\>\""}], "}"}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"implV", ",", " ", "\"\<Implicit V\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"implX", ",", "\"\<Implicit X\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"implXV", ",", "\"\<Implicit X\[SmallCircle]V\>\""}], " ", 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"implVX", ",", " ", "\"\<Implicit V\[SmallCircle]X\>\""}], 
       "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualizeSeries", "[", 
    RowBox[{"transformM_", ",", "initVec_", ",", " ", "numIters_"}], "]"}], 
   " ", ":=", "  ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "evals", ",", "evecs", ",", "\[Alpha]", ",", " ", "\[Beta]", ",", "  ", 
       "vecTrans", ",", " ", "evExpr", ",", " ", "matExpr", ",", 
       "transName"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"transM", ",", " ", "transName"}], "}"}], "=", "transformM"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<Transformation is: ``  (``)\>\"", ",", " ", 
         RowBox[{"MatrixForm", "[", "transM", "]"}], ",", "transName"}], 
        "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evals", ",", "evecs"}], "}"}], " ", "=", " ", 
       RowBox[{"Eigensystem", "[", "transM", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vecTrans", " ", "=", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{"Transpose", "[", "evecs", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", " ", "\[Beta]"}], "}"}], " ", "=", " ", 
       RowBox[{"vecTrans", ".", "initVec"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"evExpr", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"evals", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ")"}], "^", "numIters"}], " ", 
           RowBox[{"evecs", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "+", " ", 
          RowBox[{"\[Beta]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"evals", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ")"}], "^", "numIters"}], " ", 
           RowBox[{"evecs", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "//", "Expand"}], "//", 
        "MatrixForm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matExpr", " ", "=", " ", 
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{"transM", ",", " ", "numIters", ",", " ", "initVec"}], "]"}],
         "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<mat expr: ``\>\"", ",", " ", 
         RowBox[{
          RowBox[{"matExpr", "-", "initVec"}], "//", "MatrixForm"}]}], "]"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<evals=``, evecs=``\>\"", ",", " ", "evals", ",", " ", "evecs"}], 
        "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"matExpr", " ", "\[NotEqual]", " ", "evExpr"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<ev expr: ``\>\"", ",", " ", "evExpr"}], "]"}], "]"}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "StringForm", "[", "\"\<============================\>\"", "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nStep", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", " ", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "funcL", "]"}]}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VisualizeSeries", "[", 
     RowBox[{
      RowBox[{"funcL", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x0", ",", "v0"}], "}"}], ",", " ", "1"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.60560033239602*^9, 3.605600398939206*^9}, {
   3.6056004541728487`*^9, 3.605600495709503*^9}, {3.6056005536822863`*^9, 
   3.60560056682953*^9}, {3.605600653831276*^9, 3.605600658742999*^9}, {
   3.605600814790036*^9, 3.6056008187270393`*^9}, {3.6056008742490587`*^9, 
   3.605600920298069*^9}, {3.605601038190255*^9, 3.605601066222966*^9}, {
   3.605601098224512*^9, 3.6056011032872963`*^9}, {3.605601273164709*^9, 
   3.605601293662958*^9}, {3.605601329097212*^9, 3.605601343279723*^9}, {
   3.605602002480315*^9, 3.605602106618868*^9}, {3.605602148148354*^9, 
   3.60560215853097*^9}, {3.605602322539051*^9, 3.605602495826105*^9}, {
   3.605602528499683*^9, 3.6056025389615803`*^9}, {3.6056027883679647`*^9, 
   3.605602812407249*^9}, 3.605606804034772*^9, {3.60560714579617*^9, 
   3.605607151077523*^9}, {3.60560719812437*^9, 3.605607198748006*^9}, {
   3.6056079489658203`*^9, 3.605607972208695*^9}, {3.6056080044808483`*^9, 
   3.60560807581709*^9}, {3.605608477446478*^9, 3.605608485109922*^9}, {
   3.605608585177586*^9, 3.605608585322011*^9}, {3.6056102270644407`*^9, 
   3.605610280413411*^9}, {3.605610560516189*^9, 3.605610592088182*^9}, {
   3.605610684814266*^9, 3.605610727360053*^9}, 3.605610762673216*^9, {
   3.605611096234885*^9, 3.6056111052527103`*^9}, {3.6056142505272207`*^9, 
   3.605614258670555*^9}, {3.605617213036521*^9, 3.605617250459565*^9}, {
   3.605617387325863*^9, 3.605617389140711*^9}, {3.605617728132073*^9, 
   3.605617750435371*^9}, 3.605618334043914*^9, {3.6056183984701014`*^9, 
   3.605618415000731*^9}, {3.605618810538622*^9, 3.605618837306799*^9}, {
   3.605618942140833*^9, 3.605618945069845*^9}, {3.605619376464592*^9, 
   3.605619471635624*^9}, {3.605619560148131*^9, 3.605619616904578*^9}, {
   3.605619747225811*^9, 3.605619781451824*^9}, {3.605619813146988*^9, 
   3.605619838628718*^9}, {3.6056201136066227`*^9, 3.60562024725184*^9}, {
   3.605620281458988*^9, 3.605620396320159*^9}, {3.605620439205886*^9, 
   3.605620446408103*^9}, {3.605620511040626*^9, 3.6056205466911*^9}, {
   3.6056207298940983`*^9, 3.605620741411127*^9}, {3.605620774905087*^9, 
   3.605620806392289*^9}, 3.605620846432831*^9, 3.605621303996171*^9, {
   3.605621443933996*^9, 3.605621447132657*^9}, {3.6056215585202913`*^9, 
   3.6056215746784554`*^9}, {3.60562169245641*^9, 3.6056216940087767`*^9}, {
   3.6056221727867327`*^9, 3.605622244767063*^9}, {3.6056225964022007`*^9, 
   3.605622628544971*^9}, {3.6056228850610037`*^9, 3.60562291946342*^9}, {
   3.6056229940063887`*^9, 3.6056230293723783`*^9}, {3.6056231773633757`*^9, 
   3.605623246643013*^9}, {3.605623277668239*^9, 3.605623309940166*^9}, {
   3.605623568156762*^9, 3.605623575132558*^9}, 3.6056236136570683`*^9, {
   3.605623692459066*^9, 3.6056236960313053`*^9}, {3.605623993251684*^9, 
   3.605624063464241*^9}, {3.6056241867983923`*^9, 3.6056242930246964`*^9}, {
   3.605624442327565*^9, 3.605624447396853*^9}, {3.6056245044404697`*^9, 
   3.605624527605824*^9}, {3.605624608582884*^9, 3.605624611803236*^9}, {
   3.605624702780905*^9, 3.605624722476079*^9}, 3.605624785252585*^9, {
   3.605624872671302*^9, 3.6056248776992197`*^9}, {3.605624972388328*^9, 
   3.605624974837994*^9}, {3.605625006694275*^9, 3.605625215449772*^9}, {
   3.605625255757052*^9, 3.6056252608306713`*^9}, {3.6056253264776983`*^9, 
   3.605625498247805*^9}, {3.605625606758799*^9, 3.605625606911523*^9}, {
   3.605625951063884*^9, 3.605625954326497*^9}, {3.6056260567987423`*^9, 
   3.605626071136092*^9}, 3.605626884114438*^9, {3.605627098535375*^9, 
   3.605627098838092*^9}, {3.6056271718072767`*^9, 3.605627172283228*^9}, {
   3.605627226497121*^9, 3.605627226814745*^9}, {3.605627889940838*^9, 
   3.605627942836038*^9}, 3.605628532439191*^9, {3.6056312568033743`*^9, 
   3.605631268216826*^9}, {3.605632027373097*^9, 3.60563208982603*^9}, {
   3.605632425679638*^9, 3.60563243271868*^9}, {3.605632527280366*^9, 
   3.605632614290855*^9}, {3.605632691336425*^9, 3.605632727626511*^9}, {
   3.605632869102646*^9, 3.605632878160123*^9}, {3.605632924130693*^9, 
   3.605632951735855*^9}, {3.605639458259094*^9, 3.6056394796854477`*^9}, {
   3.605639563209882*^9, 3.605639563693121*^9}, 3.605639671232608*^9, {
   3.605640075664936*^9, 3.6056400757821302`*^9}, 3.6056415710232983`*^9, {
   3.605657754126873*^9, 3.6056577866369534`*^9}, {3.605657840547736*^9, 
   3.605657846852076*^9}, {3.6056578915136347`*^9, 3.605657900042026*^9}, {
   3.605657966265188*^9, 3.605657967190647*^9}, {3.605658017057859*^9, 
   3.60565809438974*^9}, {3.605658144105166*^9, 3.605658205690933*^9}, {
   3.605703906166585*^9, 3.605703935144024*^9}, {3.605704625938137*^9, 
   3.605704701184442*^9}, {3.60572560492461*^9, 3.6057258229829683`*^9}, {
   3.605725906452829*^9, 3.605725912155514*^9}, {3.605730314547867*^9, 
   3.605730367237631*^9}, {3.605737487392126*^9, 3.605737524917378*^9}, {
   3.6057433237141523`*^9, 3.6057433258813*^9}, {3.605743363645224*^9, 
   3.60574336673654*^9}, {3.605743419871035*^9, 3.6057434355505123`*^9}, {
   3.605743512553184*^9, 3.6057435922645807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "  ", 
   RowBox[{
   "MUST", " ", "compare", " ", "this", " ", "to", " ", "symplectic", " ", 
    RowBox[{
     RowBox[{"scheme", "!!"}], "!"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{
     "\[Delta]t0_", ",", " ", "numIters_", ",", " ", "plotFunc_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"plotMax", "\[Rule]", "1.3"}], ",", " ", 
         RowBox[{"imgSz", "\[Rule]", "100"}]}], "}"}], "]"}]}], " ", "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", " ", "max"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"max", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "plotMax", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{
         "\"\<\[Delta]t = `` (``), numIters = ``, cycles = ``\>\"", ",", " ", 
          "\[Delta]t0", ",", " ", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{"\[Delta]t0", "//", "N"}], ",", " ", "4"}], "]"}], ",", 
          " ", "numIters", ",", " ", 
          RowBox[{"\[Delta]t0", " ", 
           RowBox[{"numIters", "/", 
            RowBox[{"(", 
             RowBox[{"2", " ", "Pi"}], ")"}]}]}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"MatrixPower", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"funcL", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "1"}], "]"}], "]"}], "/.", 
                RowBox[{"\[Delta]t", "\[Rule]", "\[Delta]t0"}]}], "//", "N"}],
               " ", ",", "j", ",", " ", "init"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "0", ",", " ", "numIters"}], "}"}]}], 
           "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "funcL", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"plotFunc", "[", 
           RowBox[{
            RowBox[{"pts", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", ",", " ", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"OptionValue", "[", "imgSz", "]"}]}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"PointSize", "[", "0.005", "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "max"}], ",", "max"}], "}"}]}], "}"}]}], " ", 
            ",", " ", 
            RowBox[{"PlotLabel", "\[Rule]", " ", 
             RowBox[{"funcL", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "pts", "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J", " ", "=", " ", "80"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]T", " ", "=", " ", 
     RowBox[{"2", " ", 
      RowBox[{"Pi", " ", "/", " ", "J"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"K", "=", "1"}], ",", " ", 
     RowBox[{"K", "\[LessEqual]", "6"}], ",", 
     RowBox[{"K", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GenPlots", "[", 
       RowBox[{
        RowBox[{"K", " ", "\[Delta]T"}], ",", " ", "J", ",", " ", 
        "ListPlot"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{"0.25", ",", " ", "800", ",", " ", "ListLinePlot"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "4"}], ",", " ", "8", ",", " ", "ListLinePlot"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "4"}], ",", " ", "128", ",", " ", "ListPlot"}], 
     "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.605608592607132*^9, 3.60560881214625*^9}, {
   3.6056088974921722`*^9, 3.6056090034836187`*^9}, {3.6056095562697268`*^9, 
   3.605609568639738*^9}, {3.605610301697698*^9, 3.605610319644105*^9}, {
   3.605610805945249*^9, 3.605610839324493*^9}, {3.605610912159976*^9, 
   3.605610946104144*^9}, {3.60561106848419*^9, 3.6056110787566357`*^9}, {
   3.605611140935726*^9, 3.605611151566267*^9}, {3.605611418384323*^9, 
   3.605611427862656*^9}, {3.605611464849351*^9, 3.605611477575859*^9}, {
   3.605611584037052*^9, 3.605611619869125*^9}, {3.605611671360491*^9, 
   3.605611762545968*^9}, {3.605613625200865*^9, 3.6056136277220287`*^9}, {
   3.605615589670432*^9, 3.6056156795744267`*^9}, {3.605618465927072*^9, 
   3.605618539593266*^9}, {3.605618738447324*^9, 3.605618741982326*^9}, {
   3.605623403801252*^9, 3.605623410169433*^9}, {3.605623448808024*^9, 
   3.605623484247905*^9}, {3.605623527078813*^9, 3.6056235452582273`*^9}, {
   3.60562478190807*^9, 3.605624782290536*^9}, {3.605625692064006*^9, 
   3.605625692816312*^9}, {3.605625805834787*^9, 3.605625808367284*^9}, {
   3.605625840925528*^9, 3.605625841988422*^9}, {3.6056258734829473`*^9, 
   3.605625892999764*^9}, {3.6056264154963417`*^9, 3.605626471133013*^9}, {
   3.605627411706986*^9, 3.605627535155889*^9}, 3.605627665229211*^9, {
   3.6056279619233017`*^9, 3.605627990241794*^9}, {3.605628032517654*^9, 
   3.605628036228281*^9}, {3.605628076949669*^9, 3.605628092088469*^9}, {
   3.605628135801385*^9, 3.605628148569854*^9}, {3.605628182363727*^9, 
   3.605628305746829*^9}, {3.605628395524661*^9, 3.60562842666518*^9}, {
   3.605628472346036*^9, 3.6056285048745823`*^9}, {3.6056285612135897`*^9, 
   3.6056287747602*^9}, {3.6056288088413677`*^9, 3.605628866256494*^9}, {
   3.60562896378456*^9, 3.60562897531987*^9}, {3.60562912101958*^9, 
   3.605629203857896*^9}, {3.605629248730776*^9, 3.605629288248101*^9}, {
   3.605629330233424*^9, 3.605629343963958*^9}, {3.605629566467092*^9, 
   3.605629571604899*^9}, {3.605629901939686*^9, 3.605629902660944*^9}, {
   3.605630020375472*^9, 3.605630021094795*^9}, {3.605630181960957*^9, 
   3.6056301834522743`*^9}, {3.60563044731126*^9, 3.605630461027145*^9}, {
   3.6056305006998053`*^9, 3.605630501347218*^9}, {3.605630985415765*^9, 
   3.6056310103754873`*^9}, {3.605632223119989*^9, 3.605632223729767*^9}, {
   3.605632289995531*^9, 3.6056322903457537`*^9}, {3.605632340640113*^9, 
   3.605632341265686*^9}, {3.6056323853613863`*^9, 3.605632385844343*^9}, {
   3.605633072775326*^9, 3.605633146302061*^9}, {3.605633205244751*^9, 
   3.605633272229972*^9}, {3.6056333288046207`*^9, 3.605633346790099*^9}, {
   3.60563338103135*^9, 3.605633384214423*^9}, 3.605633454437619*^9, {
   3.6056335375585337`*^9, 3.605633556026739*^9}, {3.6056336131172447`*^9, 
   3.605633666719331*^9}, {3.605633743615349*^9, 3.605633866787427*^9}, {
   3.6056340112427387`*^9, 3.605634012073861*^9}, {3.605634071070557*^9, 
   3.605634078239707*^9}, {3.6056341732513533`*^9, 3.605634173352787*^9}, {
   3.60563422784979*^9, 3.605634236253274*^9}, {3.605634298285633*^9, 
   3.605634324894671*^9}, {3.6056344326359673`*^9, 3.6056344327288227`*^9}, {
   3.605634487161154*^9, 3.605634514393614*^9}, {3.605634590791922*^9, 
   3.605634637098761*^9}, {3.605634676179442*^9, 3.605634681893222*^9}, {
   3.605634725878676*^9, 3.605634773432015*^9}, {3.605634821115052*^9, 
   3.605634821768091*^9}, {3.60563500740996*^9, 3.605635019715095*^9}, {
   3.605635120773675*^9, 3.605635121636372*^9}, {3.605635232986804*^9, 
   3.6056352414653597`*^9}, {3.60563527375387*^9, 3.605635296857253*^9}, {
   3.605635783529036*^9, 3.6056357851743813`*^9}, {3.605635852652123*^9, 
   3.60563585335436*^9}, {3.605635983312625*^9, 3.60563602886549*^9}, {
   3.605636191017627*^9, 3.605636196104478*^9}, {3.6056362486741657`*^9, 
   3.605636248916338*^9}, {3.6056363635550823`*^9, 3.605636371671262*^9}, {
   3.605636514736487*^9, 3.605636515162921*^9}, {3.60563655863065*^9, 
   3.6056365593983583`*^9}, 3.605636721455502*^9, {3.6056374336016827`*^9, 
   3.605637539207242*^9}, {3.6056375901687183`*^9, 3.60563760346774*^9}, {
   3.6056377853395033`*^9, 3.6056378130477552`*^9}, {3.605637941129066*^9, 
   3.605637941704194*^9}, {3.605639043994699*^9, 3.605639086587722*^9}, {
   3.6056416417244177`*^9, 3.605641642362094*^9}, {3.605641742528125*^9, 
   3.605641742960414*^9}, 3.605657959637368*^9, 3.605657990240184*^9, {
   3.605658584333152*^9, 3.605658656043531*^9}, 3.605658714513509*^9, {
   3.6056587601811132`*^9, 3.605658774054511*^9}, 3.6056588371749163`*^9, {
   3.605658924894444*^9, 3.605658925613324*^9}, {3.605726376186413*^9, 
   3.6057264550711308`*^9}, {3.605726529536968*^9, 3.60572653144063*^9}, {
   3.6057394213725157`*^9, 3.60573950188098*^9}, {3.605739647421809*^9, 
   3.605739669916018*^9}, 3.605739743190103*^9, {3.6057409048782263`*^9, 
   3.605740912832601*^9}, {3.605741012489192*^9, 3.60574103325744*^9}, {
   3.605741189918623*^9, 3.605741203595456*^9}, {3.605741298149138*^9, 
   3.605741368247027*^9}, {3.605741575181608*^9, 3.605741580801086*^9}, {
   3.6057416684333076`*^9, 3.605741676064115*^9}, {3.605741807110609*^9, 
   3.605741844616149*^9}, {3.6057419727655573`*^9, 3.6057419801041527`*^9}, {
   3.605742144164535*^9, 3.605742147425706*^9}, {3.6057423446301203`*^9, 
   3.60574234505694*^9}, {3.6057424022484426`*^9, 3.605742423765292*^9}, {
   3.605742670292296*^9, 3.605742715167775*^9}, {3.605742814949274*^9, 
   3.605742817283287*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GenPlots", "[", 
   RowBox[{
    RowBox[{"3", 
     RowBox[{"Pi", " ", "/", " ", "5"}]}], ",", " ", "80", ",", " ", 
    "ListPlot", ",", " ", 
    RowBox[{"plotMax", "\[Rule]", "3"}], ",", " ", 
    RowBox[{"imgSz", "\[Rule]", " ", "150"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenPlots", "[", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Pi", " ", "/", " ", "3"}]}], ",", " ", "80", ",", " ", 
    "ListPlot", ",", " ", 
    RowBox[{"plotMax", "\[Rule]", "100"}], ",", " ", 
    RowBox[{"imgSz", "\[Rule]", " ", "150"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.605739757461426*^9, 3.6057397952692623`*^9}, {
  3.6057413960271072`*^9, 3.605741414667428*^9}, {3.6057424364605722`*^9, 
  3.605742443740922*^9}, {3.605743103028696*^9, 3.605743143652028*^9}, {
  3.6057432082145357`*^9, 3.605743225530534*^9}}]
},
WindowSize->{1143, 1081},
WindowMargins->{{212, Automatic}, {0, Automatic}},
ShowSelection->True,
FrontEndVersion->"8.0 for Linux x86 (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 3618, 90, 259, "Input"],
Cell[4178, 112, 2732, 76, 221, "Input"],
Cell[6913, 190, 11784, 251, 582, "Input"],
Cell[18700, 443, 10264, 198, 373, "Input"],
Cell[28967, 643, 879, 21, 50, "Input"]
}
]
*)

(* End of internal cache information *)
