(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     61840,       1456]
NotebookOptionsPosition[     61201,       1433]
NotebookOutlinePosition[     61561,       1449]
CellTagsIndexPosition[     61518,       1446]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", " ", "=", " ", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmax", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
   RowBox[{"xmax", "/", "nmax"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theTitle", " ", "=", " ", 
   RowBox[{"StringForm", "[", 
    RowBox[{"\"\<\[CapitalDelta]x = ``\>\"", ",", " ", 
     RowBox[{"\[CapitalDelta]x", "//", "N"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theX", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"n", " ", "\[CapitalDelta]x"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theExactSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y0", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", " ", "n"}], " ", "\[CapitalDelta]x"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theNumericalSoln", " ", "=", "  ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y0", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", " ", "\[CapitalDelta]x"}], ")"}], "^", "n"}]}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theImplicitSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y0", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", " ", "\[CapitalDelta]x"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"-", "n"}], ")"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "nmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "theExactSoln", ",", " ", "theNumericalSoln", ",", " ", 
     "theImplicitSoln"}], "}"}], ",", " ", 
   RowBox[{"DataRange", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "xmax"}], "}"}]}], ",", " ", 
   RowBox[{"PlotLegend", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Exact\>\"", ",", " ", "\"\<Numerical\>\"", ",", " ", 
      "\"\<Implicit\>\""}], "}"}]}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", " ", "theTitle"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6054638793268948`*^9, 3.605464073742174*^9}, {
   3.605464109315296*^9, 3.605464240641686*^9}, {3.605464289278036*^9, 
   3.605464290261372*^9}, {3.6054643415442333`*^9, 3.6054643577988253`*^9}, {
   3.605464470898169*^9, 3.605464564278079*^9}, {3.605464661157659*^9, 
   3.6054647283349867`*^9}, {3.6054651368865*^9, 3.6054651406886787`*^9}, {
   3.605465179180091*^9, 3.60546520711954*^9}, {3.605465264919607*^9, 
   3.605465320638517*^9}, {3.605465463811634*^9, 3.605465467964028*^9}, {
   3.60546558852789*^9, 3.605465603147156*^9}, {3.605466642416573*^9, 
   3.605466642513679*^9}, 3.605466697643506*^9, {3.6054667304262667`*^9, 
   3.605466731010158*^9}, 3.6054667807687473`*^9, {3.605466857895268*^9, 
   3.605466857999436*^9}, {3.605466889617135*^9, 3.605466890241385*^9}, {
   3.6054670225478163`*^9, 3.605467137113796*^9}, {3.605467249693227*^9, 
   3.6054672774234457`*^9}}],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {}, 
      {Hue[0.67, 0.6, 0.6], 
       LineBox[{{0., 1.}, {1.8, 0.16529888822158653`}, {3.6, 
        0.02732372244729256}, {5.3999999999999995`, 0.004516580942612666}, {
        7.2, 0.0007465858083766792}, {9., 0.00012340980408667956`}}]}, 
      {Hue[0.9060679774997897, 0.6, 0.6], 
       LineBox[{{0., 1.}, {1.8, -0.8}, {3.6, 0.64}, {
        5.3999999999999995`, -0.512}, {7.2, 0.4096}, {9., -0.32768}}]}, 
      {Hue[0.1421359549995791, 0.6, 0.6], 
       LineBox[{{0., 1.}, {1.8, 0.35714285714285715`}, {3.6, 
        0.12755102040816327`}, {5.3999999999999995`, 0.045553935860058306`}, {
        7.2, 0.016269262807163683`}, {9., 0.005810451002558458}}]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     AxesOrigin->{0, 0},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
       InterpretationBox[
       "\"\[CapitalDelta]x = \\!\\(TraditionalForm\\`1.8`\\)\"", 
        StringForm["\[CapitalDelta]x = ``", 1.8], Editable -> False], 
       TraditionalForm],
     PlotRange->{All, All},
     PlotRangeClipping->True,
     PlotRangePadding->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], 
   GeometricTransformationBox[GraphicsGroupBox[{
      {GrayLevel[0], 
       RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
      {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
       GraphicsGroupBox[{
         RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
          GraphicsBox[{{{InsetBox[
               GraphicsBox[{
                 {Hue[0.1421359549995791, 0.6, 0.6], 
                  LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
               Left, Bottom}, {1, 1}], 
              InsetBox["\<\"Implicit\"\>", {1.2100000000000002`, 0.58}, {-1, 0},
                Automatic, {1, 0}]}, {InsetBox[
               GraphicsBox[{
                 {Hue[0.9060679774997897, 0.6, 0.6], 
                  LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
               Left, Bottom}, {1, 1}], 
              InsetBox["\<\"Numerical\"\>", {1.2100000000000002`, 1.74}, {-1, 0},
                Automatic, {1, 0}]}, {InsetBox[
               GraphicsBox[{
                 {Hue[0.67, 0.6, 0.6], LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
               Left, Bottom}, {1, 1}], 
              InsetBox["\<\"Exact\"\>", {1.2100000000000002`, 2.9}, {-1, 0}, 
               Automatic, {1, 0}]}}, {}},
           AspectRatio->1.0952380952380953`,
           FormatType->TraditionalForm,
           
           PlotRange->{{-0.1, 3.26}, {-0.1, 
            3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
          Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}], {{{{
      0.9525984328617905, 0.}, {0., 0.37539479333940895`}}, {
      1.3629588273205566`, 0.5196503023914603}}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImagePadding->{{0., 228.31409}, {1., 100.504894}},
  ImageSize->Automatic,
  PlotRange->{{-1.2162590579710144`, -0.4033061594202897}, \
{-0.8836426844020688, -0.0024252930977207883`}},
  PlotRangePadding->Automatic]], "Input",
 CellChangeTimes->{{3.6058266404912767`*^9, 3.605826654726893*^9}}],

Cell[BoxData[{
 RowBox[{"n1max", "=", "40"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", " ", "=", " ", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]x1", " ", "=", " ", 
  RowBox[{
   RowBox[{"xmax", "/", "n1max"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]x2", " ", "=", " ", 
  RowBox[{
   RowBox[{"4", " ", "\[Delta]x1"}], "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2max", "=", 
   RowBox[{"n1max", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theExactSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", " ", "\[Delta]x1"}], ",", 
       RowBox[{"y0", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", " ", "n"}], " ", "\[Delta]x1"}], "]"}]}]}], "}"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "n1max"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theNumericalSoln", " ", "=", "  ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", " ", "\[Delta]x1"}], ",", " ", 
       RowBox[{"y0", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", " ", "\[Delta]x1"}], ")"}], "^", "n"}]}]}], "}"}],
      ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "n1max"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theImplicitSoln", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", " ", "\[Delta]x2"}], ",", 
       RowBox[{"y0", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", " ", "\[Delta]x2"}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"-", "n"}], ")"}]}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", " ", "n2max"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "theExactSoln", ",", " ", "theNumericalSoln", ",", " ", 
     "theImplicitSoln"}], "}"}], ",", " ", 
   RowBox[{"PlotLegend", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Exact\>\"", ",", " ", "\"\<Numerical\>\"", ",", " ", 
      "\"\<Implicit\>\""}], "}"}]}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", " ", "All"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.605465790690913*^9, 3.6054659977873287`*^9}, {
   3.6054660336460543`*^9, 3.605466156313572*^9}, {3.6054661992539253`*^9, 
   3.605466199343474*^9}, {3.60546626523359*^9, 3.605466270437065*^9}, 
   3.6054663577390747`*^9, {3.605466405019492*^9, 3.605466415375917*^9}, {
   3.605466498955806*^9, 3.605466505990117*^9}}],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{{}, {}, 
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQjQo+2M+aCQIn7SMTxa5xGb+C8m/avysoYnMufmpv
YgwCj+0fs0zLvtv/ECr/0r7jdqPruYN37GHmWLzXMQvrvg5V/9n+rlCV2BG3
y/bpaSDwzV6YfZtz7YTzUP0/7UX9fu/bd/2k/dkzIPDH3pirdnKzxlGoeQwO
Zxr3L14VdBCqntGBb2Np64zYPVDzmR0O7u/c5GW5HaqfxWG7QfLd6cybofax
OTTn1sjUK62HmsfhsH7DuTMbaldCzeN0cP/9f+aJe0ug5nE75E0SkfMVWwg1
j8chY4Pzz/2/ZkPN43PI38YhFvtiGtQ8AYcvNoo7Qg9OgqoXcGiZZuXAsK0P
ar6gw/flb1bdUemE6hdymHXAt49vWgvUPmEHppyCzwdvNUDNE3EoC+Z9YD+z
GmqeiEMPe0JN54wyqHmiDmLSzOW/6oug5ok5nG5zK//tlQc1T9xh8pwTwnZn
M6DmSThcuyL8MdAvBWqehEPl89NubAsSoOZJOpQ3t3QKW0ZDzZNy2Lj2Kt8Z
zzCoedIONYpFX5vsg6DmyTj0r1SZk/3QF2qejEPjqh0XLpR5QM2TdVi4SN+/
n90Fap6cg7+jlKt4mgPUPHmH5AcbQ81uWUHNU3BYqy7AovjH1B4AMFIL1Q==

        "]]}, 
      {Hue[0.9060679774997897, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQjQo+2M+aCQInofRLKH3TvkZknfvDqif2JsYg8Nj+
78qPl3yTHsDVGTjLvH5kdsseZs6XjMcdW39cgar/bN//duuC78cu2KengcA3
e5/1e2Z9un4Kqv+nvX2PwaO+yqP2Z8+AwB/7mdfUXnDrHYSax+BwZO/1m/dr
dkPVMzrMTal8WP93K9R8ZgfRV7qNM6dvhOpncego88w4pLoGah+bw0LthW2z
W5ZBzeNwkA57Pm898yKoeZwOpzpvTN90aQ7UPG6HRVfc3L7yTYeax+Ow1fnS
xdiiSVDz+Bz2XNrmf7K5F2qegIOx0ySehXPaoeoFHGJm83FtedwENV/Q4Xec
uICCZR1Uv5BD8iYhh826FVD7hB029K2YeSi8GGqeiMPz2ltfL3zKg5on4iB/
et0Rh0MZUPNEHSRtPpnNOpcMNU/MQSshYN+3DfFQ88QdQjcv+xcXFQk1T8Jh
zaHX/7w9QqDmSTh0ZXSmXrMMgJon6eCzfMVV5W+eUPOkHArkd5W/POICNU/a
Icrn96T2uQ5Q82QctKp+bF861QpqnoxDh57u5BYXU6h5sg4Luruc5jIbQs2T
c2CsXDX3t4U21Dx5h9m6oRv1j6tCzVNw2Bxerq6Wo2gPAHFaF9g=
        "]]}, 
      {Hue[0.1421359549995791, 0.6, 0.6], 
       LineBox[{{0., 1.}, {0.8, 0.5555555555555556}, {1.6, 
        0.30864197530864196`}, {2.4000000000000004`, 0.17146776406035663`}, {
        3.2, 0.09525986892242035}, {4., 0.05292214940134463}, {
        4.800000000000001, 0.02940119411185813}, {5.6000000000000005`, 
        0.01633399672881007}, {6.4, 0.009074442627116706}, {7.2, 
        0.005041357015064836}, {8., 0.0028007538972582417`}}]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     AxesOrigin->{0, 0},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotRange->{All, All},
     PlotRangeClipping->True,
     PlotRangePadding->{Automatic, Automatic}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], 
   GeometricTransformationBox[GraphicsGroupBox[{
      {GrayLevel[0], 
       RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
      {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
       GraphicsGroupBox[{
         RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
          GraphicsBox[{{{InsetBox[
               GraphicsBox[{
                 {Hue[0.1421359549995791, 0.6, 0.6], 
                  LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
               Left, Bottom}, {1, 1}], 
              InsetBox["\<\"Implicit\"\>", {1.2100000000000002`, 0.58}, {-1, 0},
                Automatic, {1, 0}]}, {InsetBox[
               GraphicsBox[{
                 {Hue[0.9060679774997897, 0.6, 0.6], 
                  LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
               Left, Bottom}, {1, 1}], 
              InsetBox["\<\"Numerical\"\>", {1.2100000000000002`, 1.74}, {-1, 0},
                Automatic, {1, 0}]}, {InsetBox[
               GraphicsBox[{
                 {Hue[0.67, 0.6, 0.6], LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
               Left, Bottom}, {1, 1}], 
              InsetBox["\<\"Exact\"\>", {1.2100000000000002`, 2.9}, {-1, 0}, 
               Automatic, {1, 0}]}}, {}},
           AspectRatio->1.0952380952380953`,
           FormatType->TraditionalForm,
           
           PlotRange->{{-0.1, 3.26}, {-0.1, 
            3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
          Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}], {{{{
      0.9841994776205967, 0.}, {0., 0.3899204958198878}}, {
      1.2404022083420998`, 0.4273109054335249}}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImagePadding->{{0., 228.31409}, {1., 100.504894}},
  ImageSize->Automatic,
  PlotRange->{{-1.2162590579710144`, -0.4033061594202897}, \
{-0.8836426844020688, -0.0024252930977207883`}},
  PlotRangePadding->Automatic]], "Input",
 CellChangeTimes->{{3.6058266645552588`*^9, 3.605826668231873*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"init", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reg", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "\[Delta]t"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]t"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"impl", " ", "=", " ", 
  RowBox[{"Inverse", "[", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", 
       RowBox[{"-", "\[Delta]t"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Delta]t", ",", " ", "1"}], "}"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implV", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"\[Delta]t", "^", "2"}]}], ",", " ", "\[Delta]t"}], "}"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]t"}], ",", " ", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implX", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "\[Delta]t"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]t"}], ",", " ", 
       RowBox[{"1", "-", 
        RowBox[{"\[Delta]t", "^", "2"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"implVX", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"implV", ".", "implX"}], "  ", "/.", " ", 
    RowBox[{"\[Delta]t", "\[Rule]", 
     RowBox[{"\[Delta]t", "/", "2"}]}]}], "//", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{"implXV", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"implX", ".", "implV"}], " ", "/.", " ", 
    RowBox[{"\[Delta]t", "\[Rule]", 
     RowBox[{"\[Delta]t", "/", "2"}]}]}], "//", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcL", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reg", ",", " ", "\"\<Fwd Euler\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"impl", ",", " ", "\"\<Euler Implicit\>\""}], "}"}], ",", " ", 
      
      RowBox[{"{", 
       RowBox[{"implV", ",", " ", "\"\<Implicit V\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"implX", ",", "\"\<Implicit X\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"implXV", ",", "\"\<Implicit X\[SmallCircle]V\>\""}], " ", 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"implVX", ",", " ", "\"\<Implicit V\[SmallCircle]X\>\""}], 
       "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AreaTransformation", "[", "transM_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dx", ",", " ", "dv", ",", " ", "new", ",", " ", "newx", ",", " ", 
       "newv", ",", " ", "dA"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"new", " ", "=", " ", 
       RowBox[{"transM", ".", 
        RowBox[{"{", 
         RowBox[{"x", ",", "v"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newx", " ", "=", " ", 
       RowBox[{
        RowBox[{"transM", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "+", "dx"}], ",", " ", "v"}], "}"}]}], "-", "new"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"newv", "=", " ", 
       RowBox[{
        RowBox[{"transM", ".", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"v", "+", "dv"}]}], "}"}]}], "-", "new"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"cross", " ", 
        RowBox[{
         RowBox[{"product", "!!"}], "!!"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dA", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"newx", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"newv", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "-", " ", 
          RowBox[{
           RowBox[{"newx", "[", 
            RowBox[{"[", "2", "]"}], "]"}], 
           RowBox[{"newv", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "//", "Expand"}], "//", 
        "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<dA = ``\>\"", ",", " ", "dA"}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<Det[transM] = ``\>\"", ",", " ", 
         RowBox[{
          RowBox[{"Det", "[", "transM", "]"}], "//", "Simplify"}]}], "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VisualizeSeries", "[", 
    RowBox[{"transformM_", ",", "initVec_", ",", " ", "numIters_"}], "]"}], 
   " ", ":=", "  ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "evals", ",", "evecs", ",", "\[Alpha]", ",", " ", "\[Beta]", ",", "  ", 
       "vecTrans", ",", " ", "evExpr", ",", " ", "matExpr", ",", 
       "transName"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"transM", ",", " ", "transName"}], "}"}], "=", "transformM"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<Transformation is: ``  (``)\>\"", ",", " ", 
         RowBox[{"MatrixForm", "[", "transM", "]"}], ",", "transName"}], 
        "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"evals", ",", "evecs"}], "}"}], " ", "=", " ", 
       RowBox[{"Eigensystem", "[", "transM", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vecTrans", " ", "=", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{"Transpose", "[", "evecs", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", " ", "\[Beta]"}], "}"}], " ", "=", " ", 
       RowBox[{"vecTrans", ".", "initVec"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"evExpr", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Alpha]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"evals", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ")"}], "^", "numIters"}], " ", 
           RowBox[{"evecs", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "+", " ", 
          RowBox[{"\[Beta]", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"evals", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ")"}], "^", "numIters"}], " ", 
           RowBox[{"evecs", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "//", "Expand"}], "//", 
        "MatrixForm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matExpr", " ", "=", " ", 
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{"transM", ",", " ", "numIters", ",", " ", "initVec"}], "]"}],
         "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<mat expr: ``\>\"", ",", " ", 
         RowBox[{"matExpr", "//", "MatrixForm"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<evals=``, evecs=``\>\"", ",", " ", "evals", ",", " ", "evecs"}], 
        "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"matExpr", " ", "\[NotEqual]", " ", "evExpr"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<ev expr: ``\>\"", ",", " ", "evExpr"}], "]"}], "]"}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AreaTransformation", "[", "transM", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "StringForm", "[", "\"\<============================\>\"", "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nStep", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", " ", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "funcL", "]"}]}], ",", " ", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VisualizeSeries", "[", 
     RowBox[{
      RowBox[{"funcL", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "v"}], "}"}], ",", " ", "1"}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.60560033239602*^9, 3.605600398939206*^9}, {
   3.6056004541728487`*^9, 3.605600495709503*^9}, {3.6056005536822863`*^9, 
   3.60560056682953*^9}, {3.605600653831276*^9, 3.605600658742999*^9}, {
   3.605600814790036*^9, 3.6056008187270393`*^9}, {3.6056008742490587`*^9, 
   3.605600920298069*^9}, {3.605601038190255*^9, 3.605601066222966*^9}, {
   3.605601098224512*^9, 3.6056011032872963`*^9}, {3.605601273164709*^9, 
   3.605601293662958*^9}, {3.605601329097212*^9, 3.605601343279723*^9}, {
   3.605602002480315*^9, 3.605602106618868*^9}, {3.605602148148354*^9, 
   3.60560215853097*^9}, {3.605602322539051*^9, 3.605602495826105*^9}, {
   3.605602528499683*^9, 3.6056025389615803`*^9}, {3.6056027883679647`*^9, 
   3.605602812407249*^9}, 3.605606804034772*^9, {3.60560714579617*^9, 
   3.605607151077523*^9}, {3.60560719812437*^9, 3.605607198748006*^9}, {
   3.6056079489658203`*^9, 3.605607972208695*^9}, {3.6056080044808483`*^9, 
   3.60560807581709*^9}, {3.605608477446478*^9, 3.605608485109922*^9}, {
   3.605608585177586*^9, 3.605608585322011*^9}, {3.6056102270644407`*^9, 
   3.605610280413411*^9}, {3.605610560516189*^9, 3.605610592088182*^9}, {
   3.605610684814266*^9, 3.605610727360053*^9}, 3.605610762673216*^9, {
   3.605611096234885*^9, 3.6056111052527103`*^9}, {3.6056142505272207`*^9, 
   3.605614258670555*^9}, {3.605617213036521*^9, 3.605617250459565*^9}, {
   3.605617387325863*^9, 3.605617389140711*^9}, {3.605617728132073*^9, 
   3.605617750435371*^9}, 3.605618334043914*^9, {3.6056183984701014`*^9, 
   3.605618415000731*^9}, {3.605618810538622*^9, 3.605618837306799*^9}, {
   3.605618942140833*^9, 3.605618945069845*^9}, {3.605619376464592*^9, 
   3.605619471635624*^9}, {3.605619560148131*^9, 3.605619616904578*^9}, {
   3.605619747225811*^9, 3.605619781451824*^9}, {3.605619813146988*^9, 
   3.605619838628718*^9}, {3.6056201136066227`*^9, 3.60562024725184*^9}, {
   3.605620281458988*^9, 3.605620396320159*^9}, {3.605620439205886*^9, 
   3.605620446408103*^9}, {3.605620511040626*^9, 3.6056205466911*^9}, {
   3.6056207298940983`*^9, 3.605620741411127*^9}, {3.605620774905087*^9, 
   3.605620806392289*^9}, 3.605620846432831*^9, 3.605621303996171*^9, {
   3.605621443933996*^9, 3.605621447132657*^9}, {3.6056215585202913`*^9, 
   3.6056215746784554`*^9}, {3.60562169245641*^9, 3.6056216940087767`*^9}, {
   3.6056221727867327`*^9, 3.605622244767063*^9}, {3.6056225964022007`*^9, 
   3.605622628544971*^9}, {3.6056228850610037`*^9, 3.60562291946342*^9}, {
   3.6056229940063887`*^9, 3.6056230293723783`*^9}, {3.6056231773633757`*^9, 
   3.605623246643013*^9}, {3.605623277668239*^9, 3.605623309940166*^9}, {
   3.605623568156762*^9, 3.605623575132558*^9}, 3.6056236136570683`*^9, {
   3.605623692459066*^9, 3.6056236960313053`*^9}, {3.605623993251684*^9, 
   3.605624063464241*^9}, {3.6056241867983923`*^9, 3.6056242930246964`*^9}, {
   3.605624442327565*^9, 3.605624447396853*^9}, {3.6056245044404697`*^9, 
   3.605624527605824*^9}, {3.605624608582884*^9, 3.605624611803236*^9}, {
   3.605624702780905*^9, 3.605624722476079*^9}, 3.605624785252585*^9, {
   3.605624872671302*^9, 3.6056248776992197`*^9}, {3.605624972388328*^9, 
   3.605624974837994*^9}, {3.605625006694275*^9, 3.605625215449772*^9}, {
   3.605625255757052*^9, 3.6056252608306713`*^9}, {3.6056253264776983`*^9, 
   3.605625498247805*^9}, {3.605625606758799*^9, 3.605625606911523*^9}, {
   3.605625951063884*^9, 3.605625954326497*^9}, {3.6056260567987423`*^9, 
   3.605626071136092*^9}, 3.605626884114438*^9, {3.605627098535375*^9, 
   3.605627098838092*^9}, {3.6056271718072767`*^9, 3.605627172283228*^9}, {
   3.605627226497121*^9, 3.605627226814745*^9}, {3.605627889940838*^9, 
   3.605627942836038*^9}, 3.605628532439191*^9, {3.6056312568033743`*^9, 
   3.605631268216826*^9}, {3.605632027373097*^9, 3.60563208982603*^9}, {
   3.605632425679638*^9, 3.60563243271868*^9}, {3.605632527280366*^9, 
   3.605632614290855*^9}, {3.605632691336425*^9, 3.605632727626511*^9}, {
   3.605632869102646*^9, 3.605632878160123*^9}, {3.605632924130693*^9, 
   3.605632951735855*^9}, {3.605639458259094*^9, 3.6056394796854477`*^9}, {
   3.605639563209882*^9, 3.605639563693121*^9}, 3.605639671232608*^9, {
   3.605640075664936*^9, 3.6056400757821302`*^9}, 3.6056415710232983`*^9, {
   3.605657754126873*^9, 3.6056577866369534`*^9}, {3.605657840547736*^9, 
   3.605657846852076*^9}, {3.6056578915136347`*^9, 3.605657900042026*^9}, {
   3.605657966265188*^9, 3.605657967190647*^9}, {3.605658017057859*^9, 
   3.60565809438974*^9}, {3.605658144105166*^9, 3.605658205690933*^9}, {
   3.605703906166585*^9, 3.605703935144024*^9}, {3.605704625938137*^9, 
   3.605704701184442*^9}, {3.60572560492461*^9, 3.6057258229829683`*^9}, {
   3.605725906452829*^9, 3.605725912155514*^9}, {3.605730314547867*^9, 
   3.605730367237631*^9}, {3.605737487392126*^9, 3.605737524917378*^9}, {
   3.6057433237141523`*^9, 3.6057433258813*^9}, {3.605743363645224*^9, 
   3.60574336673654*^9}, {3.605743419871035*^9, 3.6057434355505123`*^9}, {
   3.605743512553184*^9, 3.6057435922645807`*^9}, {3.605783319578459*^9, 
   3.605783361640829*^9}, {3.605783447516543*^9, 3.605783568756531*^9}, {
   3.605783892014168*^9, 3.605783957475081*^9}, {3.6057841121319857`*^9, 
   3.6057841168253393`*^9}, {3.605784208488062*^9, 3.6057842098230953`*^9}, {
   3.605784252010174*^9, 3.6057843290094023`*^9}, {3.605784429620997*^9, 
   3.6057844411702223`*^9}, {3.6057844816450663`*^9, 3.60578448244843*^9}, {
   3.6057845649797087`*^9, 3.605784586635902*^9}, {3.605784635911298*^9, 
   3.605784637973503*^9}, {3.605785466068523*^9, 3.605785499852453*^9}, {
   3.605785542770052*^9, 3.605785546450617*^9}, {3.605785591801647*^9, 
   3.60578559239263*^9}, {3.605786015433209*^9, 3.605786074155463*^9}, {
   3.605786165054089*^9, 3.605786200691437*^9}, {3.6057904884642887`*^9, 
   3.605790488629733*^9}, {3.605790524635336*^9, 3.6057905856214523`*^9}, {
   3.605790619392915*^9, 3.605790652506381*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "  ", 
   RowBox[{
   "MUST", " ", "compare", " ", "this", " ", "to", " ", "symplectic", " ", 
    RowBox[{
     RowBox[{"scheme", "!!"}], "!"}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{
     "\[Delta]t0_", ",", " ", "numIters_", ",", " ", "plotFunc_", ",", " ", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"plotMax", "\[Rule]", "1.3"}], ",", " ", 
         RowBox[{"imgSz", "\[Rule]", "100"}]}], "}"}], "]"}]}], " ", "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", " ", "max"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"max", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "plotMax", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{
         "\"\<\[Delta]t = `` (``), numIters = ``, cycles = ``\>\"", ",", " ", 
          "\[Delta]t0", ",", " ", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{"\[Delta]t0", "//", "N"}], ",", " ", "4"}], "]"}], ",", 
          " ", "numIters", ",", " ", 
          RowBox[{"\[Delta]t0", " ", 
           RowBox[{"numIters", "/", 
            RowBox[{"(", 
             RowBox[{"2", " ", "Pi"}], ")"}]}]}]}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Table", "[", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"MatrixPower", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"funcL", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "1"}], "]"}], "]"}], "/.", 
                RowBox[{"\[Delta]t", "\[Rule]", "\[Delta]t0"}]}], "//", "N"}],
               " ", ",", "j", ",", " ", "init"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "0", ",", " ", "numIters"}], "}"}]}], 
           "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"k", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "funcL", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"plotFunc", "[", 
           RowBox[{
            RowBox[{"pts", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", ",", " ", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"OptionValue", "[", "imgSz", "]"}]}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", " ", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"PointSize", "[", "0.005", "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "max"}], ",", "max"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "max"}], ",", "max"}], "}"}]}], "}"}]}], " ", 
            ",", " ", 
            RowBox[{"PlotLabel", "\[Rule]", " ", 
             RowBox[{"funcL", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "pts", "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"J", " ", "=", " ", "80"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Delta]T", " ", "=", " ", 
     RowBox[{"2", " ", 
      RowBox[{"Pi", " ", "/", " ", "J"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"K", "=", "1"}], ",", " ", 
     RowBox[{"K", "\[LessEqual]", "6"}], ",", 
     RowBox[{"K", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GenPlots", "[", 
       RowBox[{
        RowBox[{"K", " ", "\[Delta]T"}], ",", " ", "J", ",", " ", 
        "ListPlot"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{"0.25", ",", " ", "800", ",", " ", "ListLinePlot"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "4"}], ",", " ", "8", ",", " ", "ListLinePlot"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GenPlots", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "4"}], ",", " ", "128", ",", " ", "ListPlot"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.605608592607132*^9, 3.60560881214625*^9}, {
   3.6056088974921722`*^9, 3.6056090034836187`*^9}, {3.6056095562697268`*^9, 
   3.605609568639738*^9}, {3.605610301697698*^9, 3.605610319644105*^9}, {
   3.605610805945249*^9, 3.605610839324493*^9}, {3.605610912159976*^9, 
   3.605610946104144*^9}, {3.60561106848419*^9, 3.6056110787566357`*^9}, {
   3.605611140935726*^9, 3.605611151566267*^9}, {3.605611418384323*^9, 
   3.605611427862656*^9}, {3.605611464849351*^9, 3.605611477575859*^9}, {
   3.605611584037052*^9, 3.605611619869125*^9}, {3.605611671360491*^9, 
   3.605611762545968*^9}, {3.605613625200865*^9, 3.6056136277220287`*^9}, {
   3.605615589670432*^9, 3.6056156795744267`*^9}, {3.605618465927072*^9, 
   3.605618539593266*^9}, {3.605618738447324*^9, 3.605618741982326*^9}, {
   3.605623403801252*^9, 3.605623410169433*^9}, {3.605623448808024*^9, 
   3.605623484247905*^9}, {3.605623527078813*^9, 3.6056235452582273`*^9}, {
   3.60562478190807*^9, 3.605624782290536*^9}, {3.605625692064006*^9, 
   3.605625692816312*^9}, {3.605625805834787*^9, 3.605625808367284*^9}, {
   3.605625840925528*^9, 3.605625841988422*^9}, {3.6056258734829473`*^9, 
   3.605625892999764*^9}, {3.6056264154963417`*^9, 3.605626471133013*^9}, {
   3.605627411706986*^9, 3.605627535155889*^9}, 3.605627665229211*^9, {
   3.6056279619233017`*^9, 3.605627990241794*^9}, {3.605628032517654*^9, 
   3.605628036228281*^9}, {3.605628076949669*^9, 3.605628092088469*^9}, {
   3.605628135801385*^9, 3.605628148569854*^9}, {3.605628182363727*^9, 
   3.605628305746829*^9}, {3.605628395524661*^9, 3.60562842666518*^9}, {
   3.605628472346036*^9, 3.6056285048745823`*^9}, {3.6056285612135897`*^9, 
   3.6056287747602*^9}, {3.6056288088413677`*^9, 3.605628866256494*^9}, {
   3.60562896378456*^9, 3.60562897531987*^9}, {3.60562912101958*^9, 
   3.605629203857896*^9}, {3.605629248730776*^9, 3.605629288248101*^9}, {
   3.605629330233424*^9, 3.605629343963958*^9}, {3.605629566467092*^9, 
   3.605629571604899*^9}, {3.605629901939686*^9, 3.605629902660944*^9}, {
   3.605630020375472*^9, 3.605630021094795*^9}, {3.605630181960957*^9, 
   3.6056301834522743`*^9}, {3.60563044731126*^9, 3.605630461027145*^9}, {
   3.6056305006998053`*^9, 3.605630501347218*^9}, {3.605630985415765*^9, 
   3.6056310103754873`*^9}, {3.605632223119989*^9, 3.605632223729767*^9}, {
   3.605632289995531*^9, 3.6056322903457537`*^9}, {3.605632340640113*^9, 
   3.605632341265686*^9}, {3.6056323853613863`*^9, 3.605632385844343*^9}, {
   3.605633072775326*^9, 3.605633146302061*^9}, {3.605633205244751*^9, 
   3.605633272229972*^9}, {3.6056333288046207`*^9, 3.605633346790099*^9}, {
   3.60563338103135*^9, 3.605633384214423*^9}, 3.605633454437619*^9, {
   3.6056335375585337`*^9, 3.605633556026739*^9}, {3.6056336131172447`*^9, 
   3.605633666719331*^9}, {3.605633743615349*^9, 3.605633866787427*^9}, {
   3.6056340112427387`*^9, 3.605634012073861*^9}, {3.605634071070557*^9, 
   3.605634078239707*^9}, {3.6056341732513533`*^9, 3.605634173352787*^9}, {
   3.60563422784979*^9, 3.605634236253274*^9}, {3.605634298285633*^9, 
   3.605634324894671*^9}, {3.6056344326359673`*^9, 3.6056344327288227`*^9}, {
   3.605634487161154*^9, 3.605634514393614*^9}, {3.605634590791922*^9, 
   3.605634637098761*^9}, {3.605634676179442*^9, 3.605634681893222*^9}, {
   3.605634725878676*^9, 3.605634773432015*^9}, {3.605634821115052*^9, 
   3.605634821768091*^9}, {3.60563500740996*^9, 3.605635019715095*^9}, {
   3.605635120773675*^9, 3.605635121636372*^9}, {3.605635232986804*^9, 
   3.6056352414653597`*^9}, {3.60563527375387*^9, 3.605635296857253*^9}, {
   3.605635783529036*^9, 3.6056357851743813`*^9}, {3.605635852652123*^9, 
   3.60563585335436*^9}, {3.605635983312625*^9, 3.60563602886549*^9}, {
   3.605636191017627*^9, 3.605636196104478*^9}, {3.6056362486741657`*^9, 
   3.605636248916338*^9}, {3.6056363635550823`*^9, 3.605636371671262*^9}, {
   3.605636514736487*^9, 3.605636515162921*^9}, {3.60563655863065*^9, 
   3.6056365593983583`*^9}, 3.605636721455502*^9, {3.6056374336016827`*^9, 
   3.605637539207242*^9}, {3.6056375901687183`*^9, 3.60563760346774*^9}, {
   3.6056377853395033`*^9, 3.6056378130477552`*^9}, {3.605637941129066*^9, 
   3.605637941704194*^9}, {3.605639043994699*^9, 3.605639086587722*^9}, {
   3.6056416417244177`*^9, 3.605641642362094*^9}, {3.605641742528125*^9, 
   3.605641742960414*^9}, 3.605657959637368*^9, 3.605657990240184*^9, {
   3.605658584333152*^9, 3.605658656043531*^9}, 3.605658714513509*^9, {
   3.6056587601811132`*^9, 3.605658774054511*^9}, 3.6056588371749163`*^9, {
   3.605658924894444*^9, 3.605658925613324*^9}, {3.605726376186413*^9, 
   3.6057264550711308`*^9}, {3.605726529536968*^9, 3.60572653144063*^9}, {
   3.6057394213725157`*^9, 3.60573950188098*^9}, {3.605739647421809*^9, 
   3.605739669916018*^9}, 3.605739743190103*^9, {3.6057409048782263`*^9, 
   3.605740912832601*^9}, {3.605741012489192*^9, 3.60574103325744*^9}, {
   3.605741189918623*^9, 3.605741203595456*^9}, {3.605741298149138*^9, 
   3.605741368247027*^9}, {3.605741575181608*^9, 3.605741580801086*^9}, {
   3.6057416684333076`*^9, 3.605741676064115*^9}, {3.605741807110609*^9, 
   3.605741844616149*^9}, {3.6057419727655573`*^9, 3.6057419801041527`*^9}, {
   3.605742144164535*^9, 3.605742147425706*^9}, {3.6057423446301203`*^9, 
   3.60574234505694*^9}, {3.6057424022484426`*^9, 3.605742423765292*^9}, {
   3.605742670292296*^9, 3.605742715167775*^9}, {3.605742814949274*^9, 
   3.605742817283287*^9}, 3.6058248557373343`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GenPlots", "[", 
   RowBox[{
    RowBox[{"3", 
     RowBox[{"Pi", " ", "/", " ", "5"}]}], ",", " ", "80", ",", " ", 
    "ListPlot", ",", " ", 
    RowBox[{"plotMax", "\[Rule]", "3"}], ",", " ", 
    RowBox[{"imgSz", "\[Rule]", " ", "150"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenPlots", "[", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Pi", " ", "/", " ", "3"}]}], ",", " ", "80", ",", " ", 
    "ListPlot", ",", " ", 
    RowBox[{"plotMax", "\[Rule]", "100"}], ",", " ", 
    RowBox[{"imgSz", "\[Rule]", " ", "150"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.605739757461426*^9, 3.6057397952692623`*^9}, {
  3.6057413960271072`*^9, 3.605741414667428*^9}, {3.6057424364605722`*^9, 
  3.605742443740922*^9}, {3.605743103028696*^9, 3.605743143652028*^9}, {
  3.6057432082145357`*^9, 3.605743225530534*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TransformationProperties", "[", "eqnL_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sol", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{"eqnL", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"n", "+", "1"}], "]"}], ",", " ", 
           RowBox[{"v", "[", 
            RowBox[{"n", "+", "1"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f1", " ", "=", " ", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "/.", " ", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f2", " ", "=", " ", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "/.", " ", 
        RowBox[{"sol", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<f1 = ``, f2 = ``\>\"", ",", " ", "f1", ",", " ", "f2"}], 
        "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"jac", " ", "=", " ", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"f1", ",", " ", "f2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "[", "n", "]"}], ",", " ", 
            RowBox[{"v", "[", "n", "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{
        "\"\<Jacobian = ``, Det[Jacobian]=``\>\"", ",", " ", "jac", ",", " ", 
         
         RowBox[{"Det", "[", "jac", "]"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "StringForm", "[", "\"\<============================\>\"", "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"euler", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
       RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"v", "[", "n", "]"}], " ", "\[Delta]t"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
       RowBox[{"v", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", "n", "]"}], "]"}]}], " ", "\[Delta]t"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implicit", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
       RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "\[Delta]t"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
       RowBox[{"v", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "]"}]}], " ", "\[Delta]t"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implicitV", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
       RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "\[Delta]t"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
       RowBox[{"v", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", "n", "]"}], "]"}]}], " ", "\[Delta]t"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implicitX", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
       RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"v", "[", "n", "]"}], " ", "\[Delta]t"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
       RowBox[{"v", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "]"}]}], " ", "\[Delta]t"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"implicitVf", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
       RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], " ", "\[Delta]t"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
       RowBox[{"v", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"f", "[", 
         RowBox[{"x", "[", "n", "]"}], "]"}]}], " ", "\[Delta]t"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"implicitXf", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
        RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
       RowBox[{
        RowBox[{"v", "[", "n", "]"}], " ", "\[Delta]t"}]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
        RowBox[{"v", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"f", "[", 
          RowBox[{"x", "[", 
           RowBox[{"n", "+", "1"}], "]"}], "]"}]}], " ", "\[Delta]t"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"TransformationProperties", "[", "implicit", "]"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"TransformationProperties", "[", "euler", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TransformationProperties", "[", "implicitV", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TransformationProperties", "[", "implicitX", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TransformationProperties", "[", "implicitVf", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TransformationProperties", "[", "implicitXf", "]"}]}], "Input",
 CellChangeTimes->{{3.60579662748904*^9, 3.605796722631424*^9}, 
   3.605796782881838*^9, {3.605796864140071*^9, 3.605797148565613*^9}, {
   3.605797270665659*^9, 3.60579727892172*^9}, {3.605797321644205*^9, 
   3.60579732274737*^9}, {3.605799775981142*^9, 3.605799777270825*^9}, {
   3.6057998126534777`*^9, 3.605799815740179*^9}, {3.605799947758019*^9, 
   3.605799959618225*^9}, {3.605800012087579*^9, 3.605800018599484*^9}, {
   3.6058001154107122`*^9, 3.605800188194124*^9}, {3.6058002193419933`*^9, 
   3.605800235335473*^9}, {3.605800288066943*^9, 3.60580035698376*^9}, {
   3.605800445484309*^9, 3.6058004501980124`*^9}, {3.605801168253415*^9, 
   3.60580117221218*^9}, {3.605801326562928*^9, 3.605801403941618*^9}, {
   3.6058134615811443`*^9, 3.6058134825955753`*^9}, {3.6058268688380404`*^9, 
   3.6058268698791656`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"keep", " ", "going", " ", "this", " ", "way"}], ",", " ", 
   RowBox[{
   "we", " ", "will", " ", "find", " ", "symplectic", " ", "transforms", " ", 
    "for", " ", "the", " ", "gyromotion", " ", "case"}], ",", " ", 
   "somehow"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6058014425832787`*^9, 3.605801462028098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "need", " ", "to", " ", "invesitagte", " ", "not", " ", "just", " ", 
     RowBox[{"det", "[", "Jac", "]"}], " ", "but", " ", "also", " ", "Jav", 
     " ", "J", " ", 
     RowBox[{"jac", "^", "T"}]}], " ", "=", " ", "I"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GyroTransformationProperties", "[", "eqnL_", "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sol", ",", " ", "f1", ",", " ", "f2", ",", " ", "f3", ",", " ", "f4", 
        ",", " ", "jac"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sol", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{"eqnL", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"n", "+", "1"}], "]"}], ",", " ", 
            RowBox[{"y", "[", 
             RowBox[{"n", "+", "1"}], "]"}], ",", " ", 
            RowBox[{"vx", "[", 
             RowBox[{"n", "+", "1"}], "]"}], ",", " ", 
            RowBox[{"vy", "[", 
             RowBox[{"n", "+", "1"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"n", "+", "1"}], "]"}], "/.", " ", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "//", "Expand"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"n", "+", "1"}], "]"}], "/.", " ", 
          RowBox[{"sol", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "//", "Expand"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f3", " ", "=", " ", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "/.", " ", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f4", " ", "=", " ", 
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "/.", " ", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<f1 = ``\>\"", ",", " ", "f1"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<f2 = ``\>\"", ",", " ", "f2"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<f3 = ``\>\"", ",", " ", "f3"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<f4 = ``\>\"", ",", " ", "f4"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"jac", " ", "=", " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f1", ",", " ", "f2", ",", " ", "f3", ",", " ", "f4"}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", "n", "]"}], ",", " ", 
             RowBox[{"y", "[", "n", "]"}], ",", " ", 
             RowBox[{"vx", "[", "n", "]"}], ",", " ", 
             RowBox[{"vy", "[", "n", "]"}]}], "}"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"False", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Jacobian = ``\>\"", ",", " ", "jac"}], "]"}], "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Det[Jacobian]=``\>\"", ",", " ", 
          RowBox[{
           RowBox[{"Det", "[", "jac", "]"}], "//", "Simplify"}]}], "]"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "StringForm", "[", "\"\<============================\>\"", "]"}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"euler", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{
         RowBox[{"vx", "[", "n", "]"}], " ", "\[Delta]t"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"y", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{
         RowBox[{"vy", "[", "n", "]"}], " ", "\[Delta]t"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
         RowBox[{"vx", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{"qovm", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Ex", "[", 
             RowBox[{
              RowBox[{"x", "[", "n", "]"}], ",", "y"}], "]"}], "[", "n", 
            "]"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"vy", "[", "n", "]"}], " ", "Bz"}]}], ")"}], 
         "\[Delta]t"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
         RowBox[{"vy", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{"qovm", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ey", "[", 
            RowBox[{
             RowBox[{"x", "[", "n", "]"}], ",", 
             RowBox[{"y", "[", "n", "]"}]}], "]"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"vx", "[", "n", "]"}], " ", "Bz"}]}], ")"}], 
         "\[Delta]t"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"implicitV", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "\[Delta]t"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"y", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "\[Delta]t"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
         RowBox[{"vx", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{"qovm", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ex", "[", 
            RowBox[{
             RowBox[{"x", "[", "n", "]"}], ",", 
             RowBox[{"y", "[", "n", "]"}]}], "]"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"vy", "[", 
             RowBox[{"n", "+", "1"}], "]"}], " ", "Bz"}]}], ")"}], 
         "\[Delta]t"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
         RowBox[{"vy", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{"qovm", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ey", "[", 
            RowBox[{
             RowBox[{"x", "[", "n", "]"}], ",", 
             RowBox[{"y", "[", "n", "]"}]}], "]"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"vx", "[", 
             RowBox[{"n", "+", "1"}], "]"}], " ", "Bz"}]}], ")"}], 
         "\[Delta]t"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"borisV", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"x", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "\[Delta]t"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"y", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"n", "+", "1"}], "]"}], " ", "\[Delta]t"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
         RowBox[{"vx", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{"qovm", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ex", "[", 
            RowBox[{
             RowBox[{"x", "[", "n", "]"}], ",", 
             RowBox[{"y", "[", "n", "]"}]}], "]"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vy", "[", "n", "]"}], "+", " ", 
              RowBox[{"vy", "[", 
               RowBox[{"n", "+", "1"}], "]"}]}], ")"}], " ", "Bz"}]}], ")"}], 
         "\[Delta]t"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"vy", "[", 
          RowBox[{"n", "+", "1"}], "]"}], "-", " ", 
         RowBox[{"vy", "[", "n", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{"qovm", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ey", "[", 
            RowBox[{
             RowBox[{"x", "[", "n", "]"}], ",", 
             RowBox[{"y", "[", "n", "]"}]}], "]"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vx", "[", "n", "]"}], " ", "+", 
              RowBox[{"vx", "[", 
               RowBox[{"n", "+", "1"}], "]"}]}], ")"}], "Bz"}]}], ")"}], 
         "\[Delta]t"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"GyroTransformationProperties", "[", "euler", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GyroTransformationProperties", "[", "implicitV", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"GyroTransformationProperties", "[", "borisV", "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6058135107160273`*^9, 3.605813529387534*^9}, {
   3.605813622447826*^9, 3.605813712804862*^9}, {3.605813840533964*^9, 
   3.605813861999877*^9}, {3.605813909442493*^9, 3.605813964130862*^9}, {
   3.605813999046404*^9, 3.60581414231977*^9}, {3.605814460019541*^9, 
   3.605814483347962*^9}, {3.605814581842379*^9, 3.605814598140358*^9}, {
   3.605814784007633*^9, 3.60581479229473*^9}, {3.6058148555459967`*^9, 
   3.605814920380204*^9}, {3.605814964302424*^9, 3.605814966638363*^9}, {
   3.605815136570325*^9, 3.605815149579137*^9}, 3.605815217563884*^9, {
   3.6058152837394943`*^9, 3.605815434969408*^9}, {3.6058155773334637`*^9, 
   3.6058156326998672`*^9}, {3.605824679882534*^9, 3.605824743057976*^9}, {
   3.605825033992756*^9, 3.605825117566716*^9}, {3.6058251906574*^9, 
   3.605825205843636*^9}, {3.605825309810541*^9, 3.605825311205798*^9}, {
   3.605825378406427*^9, 3.605825409846923*^9}, {3.605825454023555*^9, 
   3.605825489016988*^9}, {3.6058255275635147`*^9, 3.605825531772377*^9}, {
   3.605825564764366*^9, 3.6058256039969473`*^9}, 3.6058258031889753`*^9, {
   3.605826051050555*^9, 3.605826052556754*^9}, {3.605826086286676*^9, 
   3.605826091530854*^9}, {3.605826398408033*^9, 3.605826450279172*^9}, {
   3.605826875642537*^9, 3.605826877338731*^9}}]
},
WindowSize->{1130, 1081},
WindowMargins->{{224, Automatic}, {0, Automatic}},
ShowSelection->True,
FrontEndVersion->"8.0 for Linux x86 (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 3618, 90, 259, "Input"],
Cell[4178, 112, 3544, 73, 259, "Input"],
Cell[7725, 187, 2732, 76, 221, "Input"],
Cell[10460, 265, 4603, 91, 259, "Input"],
Cell[15066, 358, 14871, 323, 791, "Input"],
Cell[29940, 683, 10265, 198, 354, "Input"],
Cell[40208, 883, 879, 21, 50, "Input"],
Cell[41090, 906, 7886, 213, 487, "Input"],
Cell[48979, 1121, 382, 8, 30, "Input"],
Cell[49364, 1131, 11833, 300, 601, "Input"]
}
]
*)

(* End of internal cache information *)
